<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ratings of user</title>
    <link rel="stylesheet" href="stylesheet/ratings.css">
</head>

<body>



<div class="ratings">

    <div class="top">
        <h1 style="float:left;"><span id="username">USER</span> has rated a film <span style="color:rebeccapurple" id="ratingvalue"></span></h1>
        <p style="color:grey; float:right">(<span id="datetime">DATE</span>)</p>
    </div>


    <div class="left">
        <img id="posterUrl" src="">
    </div>

    <div class="right">
        <h1><span id="title">FILM </span> </h1>
        <p>Directed by <span style="font-style:italic" id="directors"></span>.</p>
        <p>Written by <span style="font-style:italic" id="writers"></span></p>
        <p>Genres: <span style="font-style:italic" id="genres"></span></p>
        <p id="tofill"></p>
    </div>

    <div class="below">
        <p>COMMENTS:</p>
        <p id="commentshere"></p>
    </div>

</div>


</body>

<script>
    fetch_func = function() {
        let ratingId = "sdelarivtt4468740"
        fetch("http://localhost:8080/rating/" + ratingId)
            .then( resp => resp.json() )
            .then( rating => {
                //Todos toevoegen/afdrukken in het document
                let allTodos = ''
                let username = '[user_not_found]';
                let title = '[title_not_found]';
                let ratingvalue = ' - ';
                let posterUrl = '';
                let commentstring = '';
                let date = '';
                let directors = '';
                let writers ='';
                let genres ='';
                    allTodos = allTodos + JSON.stringify(rating) + "<br>";
                    username = rating.user.username;
                    title = rating.film.title;
                    ratingvalue = ratingvalue + rating.ratingValue + '/100';
                    posterUrl = rating.film.posterUrl
                    date = date + rating.dateOfRating;
                    console.log(rating.dateOfRating);

                    rating.film.director.forEach(director => directors = directors + director.name + ', ');
                    rating.film.writer.forEach(writer => writers = writers + writer.name + ', ');

                // document.getElementById("tofill").innerHTML = allTodos
                document.getElementById("username").innerHTML = username
                document.getElementById("title").innerHTML = title
                document.getElementById("ratingvalue").innerHTML = ratingvalue
                document.getElementById("posterUrl").setAttribute("src",posterUrl);
                document.getElementById("datetime").innerHtml= date;

                document.getElementById("directors").innerHTML = directors.substring(0,directors.length-2);
                document.getElementById("writers").innerHTML = writers.substring(0,writers.length-2);


                rating.commentList.forEach(c => {
                    if (c != null && c.user != null && c.user.username != null) commentstring = commentstring + '<strong>' + c.user.username + '</strong><br>' + c.comment + '<br>'      });
                console.log(commentstring);

                document.getElementById("commentshere").innerHTML = commentstring;

            })
    }


    fetch_func()



</script>

</html>